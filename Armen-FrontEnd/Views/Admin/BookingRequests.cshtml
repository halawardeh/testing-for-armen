@{
    ViewData["Title"] = "طلبات الحجز";
    Layout = "~/Views/Shared/AdminLayout.cshtml";
}

@section Styles {
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
            background-color: #f8f9fa;
        }

        .booking-table {
            font-size: 15px;
            border-radius: 10px;
            overflow: hidden;
        }

            .booking-table th {
                background: linear-gradient(90deg, #025F70 60%, #0bb6d7 100%);
                color: white;
                text-align: center;
            }

            .booking-table td {
                vertical-align: middle;
                text-align: center;
            }

        .status-label {
            font-weight: bold;
            padding: 4px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .status-pending {
            background-color: #fef3c7;
            color: #b45309;
        }

        .status-confirmed {
            background-color: #d1fae5;
            color: #065f46;
        }

        .status-cancelled {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .booking-action-btn {
            border-radius: 30px;
            font-weight: bold;
            padding: 6px 16px;
            font-size: 0.9rem;
            margin: 2px;
            transition: all 0.2s ease-in-out;
        }

            .booking-action-btn.view {
                background: #0bb6d7;
                color: white;
            }

            .booking-action-btn.delete {
                background: #e11d48;
                color: white;
            }

            .booking-action-btn.view:hover {
                background: #025F70;
            }

            .booking-action-btn.delete:hover {
                background: #b91c1c;
            }
    </style>
}

<div class="container py-4">
    <h2 class="mb-4 text-center" style="color: #025F70; font-weight: 700;">طلبات الحجز للفنادق</h2>

    <div class="table-responsive">
        <table id="bookingTable" class="table table-bordered table-hover booking-table">
            <thead>
                <tr>
                    <th>رقم الطلب</th>
                    <th>اسم العميل</th>
                    <th>الفندق</th>
                    <th>تاريخ الحجز</th>
                    <th>الحالة</th>
                    <th>الإجراءات</th>
                </tr>
            </thead>
            <tbody id="bookingRequestsBody">
                <!-- يتم تعبئة الصفوف هنا -->
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

    <script>
        let bookingRequests = [
            { id: 'BR-1001', customer: 'محمد أحمد', hotel: 'فندق الصين الدولي', date: '2025-01-21', status: 'pending' },
            { id: 'BR-1002', customer: 'سارة علي', hotel: 'فندق شنغهاي', date: '2025-01-22', status: 'confirmed' },
            { id: 'BR-1003', customer: 'خالد يوسف', hotel: 'فندق بكين', date: '2025-01-23', status: 'cancelled' },
            { id: 'BR-1004', customer: 'ليلى محمود', hotel: 'فندق قوانغتشو', date: '2025-01-24', status: 'pending' },
            { id: 'BR-1005', customer: 'أحمد سمير', hotel: 'فندق الصين الدولي', date: '2025-01-25', status: 'confirmed' },
            { id: 'BR-1006', customer: 'يوسف فؤاد', hotel: 'فندق شنغهاي', date: '2025-01-26', status: 'pending' },
            { id: 'BR-1007', customer: 'منى جابر', hotel: 'فندق قوانغتشو', date: '2025-01-27', status: 'confirmed' },
            { id: 'BR-1008', customer: 'رامي عادل', hotel: 'فندق بكين', date: '2025-01-28', status: 'pending' },
            { id: 'BR-1009', customer: 'هبة خالد', hotel: 'فندق الصين الدولي', date: '2025-01-29', status: 'cancelled' },
            { id: 'BR-1010', customer: 'فارس محمود', hotel: 'فندق شنغهاي', date: '2025-01-30', status: 'confirmed' }
        ];

        function getStatusBadge(status) {
            switch (status) {
                case 'pending':
                    return '<span class="status-label status-pending">قيد الانتظار</span>';
                case 'confirmed':
                    return '<span class="status-label status-confirmed">مؤكد</span>';
                case 'cancelled':
                    return '<span class="status-label status-cancelled">ملغي</span>';
                default:
                    return '';
            }
        }

        function renderTable() {
            const tbody = $('#bookingRequestsBody');
            tbody.empty();
            bookingRequests.forEach(req => {
                tbody.append(`
                    <tr>
                        <td>${req.id}</td>
                        <td>${req.customer}</td>
                        <td>${req.hotel}</td>
                        <td>${req.date}</td>
                        <td>${getStatusBadge(req.status)}</td>
                        <td>
                            <button class="booking-action-btn view" onclick="viewBooking('${req.id}')">
                                <i class="fas fa-eye"></i> عرض
                            </button>
                            <button class="booking-action-btn delete" onclick="deleteBooking('${req.id}')">
                                <i class="fas fa-trash-alt"></i> حذف
                            </button>
                        </td>
                    </tr>
                `);
            });

            $('#bookingTable').DataTable({
                language: {
                    url: "//cdn.datatables.net/plug-ins/1.13.4/i18n/ar.json"
                },
                destroy: true
            });
        }

        function viewBooking(id) {
            const req = bookingRequests.find(r => r.id === id);
            if (req) {
                alert(`تفاصيل الطلب:\nرقم الطلب: ${req.id}\nالعميل: ${req.customer}\nالفندق: ${req.hotel}\nتاريخ الحجز: ${req.date}`);
            }
        }

        function deleteBooking(id) {
            if (confirm('هل تريد حذف هذا الطلب؟')) {
                bookingRequests = bookingRequests.filter(r => r.id !== id);
                $('#bookingTable').DataTable().destroy();
                renderTable();
            }
        }

        $(document).ready(function () {
            renderTable();
        });
    </script>
}
